{% extends "newbase_with_actions.html" %}

{% block head %}
    <link rel="stylesheet" href="{{ STATIC_URL }}fontello/css/fontello.css">
    <link rel="stylesheet" href="{{ STATIC_URL }}fontello/css/animation.css"><!--[if IE 7]>
    <link rel="stylesheet" href="{{ STATIC_URL }}fontello/css/fontello-ie7.css"><![endif]-->
{% endblock head %}

{% block actions %}
    <h3 class="thin">Page actions</h3>
    <a class="action" href="{% url 'block-list' %}">View all activities</a>        
{% endblock actions %}

{% block maincontent %}
    <h1 class="thin">Your teaching activities</h1>
    <div class="row spacer">
    {% for w, l in object_list %}
    {% if forloop.first %}{% endif %}
    <div class="week">
        <div class="week-heading collapse-trigger" data-target="#week-activities-{{ w.id }}">
            <h3 class="thin">{{ w }}</h3>
            <i class="icon-angle-down"></i>
        </div>
        <div class="week-activities collapse in" id="week-activities-{{ w.id }}">
            {% for t in l %}
            {% if t %}
                <div class="activity">
                    <span>{{ t }}</span>
                    <span class="actions hidden-phone pull-right">
                        <a class="action" href="{% url 'ta' pk=t.id %}">
                            View
                        </a>
                    </span>
                </div>                
            {% endif %}
            {% endfor %}
        </div>
    </div>
    {% if forloop.last %}{% endif %}
    {% empty %}
    <p>You haven't signed up to any activities yet. You can do this by clicking "Choose more activities" <span class="hidden-phone">to the right</span><span><span class="visible-phone">below</span></span>.</p>
    {% endfor %}
    </div>
{% endblock maincontent %}


{% block javascript %}
   <script type="text/javascript">
        function unclickable(cls, handler) {
            $(cls).off("click",handler)
        }
        function clickable(cls, handler) {
            $(cls).on("click", handler)
        }
        function go () {
            a = $(this)
            document.location.href = a.find("a.action").attr("href")
        }
        enquire.register("screen and (max-width: 767px)", {
            match: function () {
                clickable(".activity", go)
            },
            unmatch: function () {
                unclickable(".activity", go)
            }
        })
        $(document).ready(function () {
            $(".collapse-trigger").each(function () {
                $($(this).attr("data-target")).collapse()

                $(this).click(function () {
                    $($(this).attr("data-target")).collapse("toggle")
                })
            })
        })
    </script>
{% endblock javascript %}